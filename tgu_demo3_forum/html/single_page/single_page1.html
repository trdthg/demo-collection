<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css"/>
		<style type="text/css">
		body{
			background-color: #fcfcfc;
		}
			#container {
				width: 65%;
				margin: 50px auto;
				padding: 50px 40px;
				box-shadow: 0 2px 6px rgb(100 100 100 / 30%);	
				color: #444;
				background-color: white;
			}

			h1,
			h2,
			p {
				margin: 0;
			}

			.gray {
				color: #757575;
			}

			p {
				font-weight: normal;
			}

			img {
				width: 100%;
			}
		</style>
	</head>
	<body>
		<div id="container" class="container">
			<h1>笔记 | 画出云朵图</h1>
			<p>非常漂亮的云朵</p>
			<hr>
			<p>备用知识：并查集，最小生成树</p><br>
			<p>首先先用js生成许多div，作为像素，进行操作<br></p>
			<pre>
			var x = 200,
				y = 200;
			// 添加元素
			for (var i = 0; i < x; i++) {
				var d = document.createElement("div");
				d.className = "line";
				for (var j = 0; j < y; j++) {
					var s = document.createElement("span");
					s.id = "grid" + i + "-" + j;
					s.className = "grid";
					d.appendChild(s);
				}
				document.body.appendChild(d);
			}
			</pre>
			<p>然后生成边</p>
			<pre>	
			var arr = new Array();

			for (var i = 1; i < x; i++) {
				for (var j = 0; j < y; j++) {
					arr.push(new edge(i - 1, j, i, j));
				}
			}
			for (var i = 0; i < x; i++) {
				for (var j = 1; j < y; j++) {
					arr.push(new edge(i, j - 1, i, j));
				}
			}

			</pre>
			<p>再把边打乱</p>
			<pre>
				function randArr(arr) {
					for (var i = 0; i < arr.length; i++) {
						var iRand = parseInt(arr.length * Math.random());
						var temp = arr[i];
						arr[i] = arr[iRand];
						arr[iRand] = temp;
					}
					return arr;
				}
				randArr(arr);
			</pre>
			<p>把边连起来</p>
			<pre>
				var father = new Array();
				for (var i = 0; i < x; i++) {
					father[i] = new Array();
					for (var j = 0; j < y; j++) {
						father[i][j] = new _node(i, j);
					}
				}
				var _nodes = x * y;
				var e = new Array();
				for (var i = 0; i < x; i++) {
					e[i] = new Array();
					for (var j = 0; j < y; j++) {
						e[i][j] = new Array();
					}
				}
				
				function equal(a, b) {
					return a.x == b.x && a.y == b.y;
				}
				
				function findFather(dt) {
					if (equal(father[dt.x][dt.y], dt)) {
						return dt;
					} else {
						return (father[dt.x][dt.y] = findFather(father[dt.x][dt.y]));
					}
				}
				
				function print(str, dt) {
					console.log(str + dt.x + dt.y);
				}
				
				function _union(d1, d2) {
					if (!equal(findFather(d1), findFather(d2))) {
						_nodes -= 1;
						var f1 = findFather(d1);
						father[f1.x][f1.y] = findFather(d2);
						e[d1.x][d1.y].push(d2);
						e[d2.x][d2.y].push(d1);
					}
				}
				for (var i = 0; i < arr.length; i++) {
					if (_nodes == 1) break;
					_union(arr[i].u, arr[i].v);
				}
				var visited = new Array();
				for (var i = 0; i < x; i++) {
					visited[i] = new Array();
					for (var j = 0; j < y; j++) {
						visited[i][j] = false;
					}
				}
			</pre>
			<p>设置初始点并开始深搜</p>
			<pre>
				var begin = new _node(
					Math.floor(Math.random() * x),
					Math.floor(Math.random() * x)
				);
				var _color = new Color();
				_color.next_color();
				var old = 0;
				
				function replace_color(i, j, depth) {
					var obj = document.getElementById("grid" + i + "-" + j);
					obj.style.backgroundColor = _color.to_str();
					if (depth != old) {
						_color.next_color();
						depth = old;
					}
				}
				
				function traverse(dot, depth, i) {
					if (i == e[dot.x][dot.y].length) return;
					var nxt = e[dot.x][dot.y][i];
					if (!visited[nxt.x][nxt.y]) {
						visited[nxt.x][nxt.y] = true;
						var next_step = {
							fun: function () {
								dfs(nxt, depth + 1);
							},
							Animation: function () {
								window.requestAnimationFrame(this.fun);
							},
						};
						next_step.Animation();
					}
					var next_direction = {
						traverse_: function () {
							traverse(dot, depth, i + 1);
						},
						Animation: function () {
							window.requestAnimationFrame(this.traverse_);
						},
					};
					next_direction.Animation();
				}
				
				function dfs(dot, depth) {
					replace_color(dot.x, dot.y, depth);
					traverse(dot, depth, 0);
				}
				visited[begin.x][begin.y] = true;
				dfs(begin, 0);
			</pre>
			<p>效果如下</p>
			<iframe src="整活-广搜.html" width="100%" height="500px"></iframe>
			<a href="整活-深搜 - 动态.html" target="dynamic">点我重新加载动态云朵</a><br>
			<iframe src="整活-深搜 - 动态.html" name="dynamic" width="100%" height="600px"></iframe>
		</div>
		
	</body>
</html>
